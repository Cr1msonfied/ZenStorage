/*

███████  ██████  ██████  ████████ ███    ██ ██ ████████ ███████ 
██      ██    ██ ██   ██    ██    ████   ██ ██    ██    ██      
█████   ██    ██ ██████     ██    ██ ██  ██ ██    ██    █████   
██      ██    ██ ██   ██    ██    ██  ██ ██ ██    ██    ██      
██       ██████  ██   ██    ██    ██   ████ ██    ██    ███████ 
  ______   _____  _____     ________  ____  _____  _________         _       _____  ____    ____      _______  _______      ___        ____   ____  __    
.' ____ \ |_   _||_   _|   |_   __  ||_   \|_   _||  _   _  |       / \     |_   _||_   \  /   _|    |_   __ \|_   __ \   .'   `.     |_  _| |_  _|/  |   
| (___ \_|  | |    | |       | |_ \_|  |   \ | |  |_/ | | \_|      / _ \      | |    |   \/   |        | |__) | | |__) | /  .-.  \      \ \   / /  `| |   
 _.____`.   | |    | |   _   |  _| _   | |\ \| |      | |         / ___ \     | |    | |\  /| |        |  ___/  |  __ /  | |   | |       \ \ / /    | |           
| \____) | _| |_  _| |__/ | _| |__/ | _| |_\   |_    _| |_      _/ /   \ \_  _| |_  _| |_\/_| |_      _| |_    _| |  \ \_\  `-'  /        \ ' /    _| |_  
 \______.'|_____||________||________||_____|\____|  |_____|    |____| |____||_____||_____||_____|    |_____|  |____| |___|`.___.'          \_/    |_____| 
                                                                                                                                                          
 ********************************************************************************************************************************************************
 --------------------------------------------------------------------------------------------------------------------------------------------------------
  _____             __         __    __            ____           __     _ __    __  ________
 / ___/______ ___ _/ /____ ___/ /   / /  __ __    / __/_ __ ___  / /__  (_) /_   \ \/ /_  __/
/ /__/ __/ -_) _ `/ __/ -_) _  /   / _ \/ // /   / _/ \ \ // _ \/ / _ \/ / __/    \  / / /   
\___/_/  \__/\_,_/\__/\__/\_,_/   /_.__/\_, /   /___//_\_\/ .__/_/\___/_/\__/     /_/ /_/    
                                       /___/             /_/                                 
=============================================================================================================================
  Instructions - Please Read                                                                                            
=============================================================================================================================
        /*------------------------------- INSTRUCTIONS PLEASE READ ------------------------------------------
        =====================================================================================================
        Enter Mod Menu                        = hold LT/L2 & press XB1_MENU  
        -----------------------------------------------------------------------------------------------------
        Scroll between MODs  Go back          = XB1_LEFT 
        -----------------------------------------------------------------------------------------------------
        Scroll between MODs  Go forward       = XB1_RIGHT 
        -----------------------------------------------------------------------------------------------------
        Scroll between Options Go back        = XB1_UP 
        -----------------------------------------------------------------------------------------------------
        Scroll between Options Go forward     = XB1_DOWN 
        -----------------------------------------------------------------------------------------------------
        Exit Menu                             = XB1_B 
        -----------------------------------------------------------------------------------------------------
        Enter Edit Menu To Change Values      = XB1_A 
        -----------------------------------------------------------------------------------------------------
        Exit Edit Menu To Mod Menu            = XB1_B
        -----------------------------------------------------------------------------------------------------
        Edit Menu - change values by 1        = hold LT/L2 & press LEFT(decrease by 1)/RIGHT(increase by 1)
        -----------------------------------------------------------------------------------------------------
        Edit Menu - change values by 10       = hold LT/L2 & press DOWN(decrease by 10)/UP(increase by 10)
        -----------------------------------------------------------------------------------------------------
        ====================================================================================================*/



// 100% Accuracy Spam (1 BUTTON)
//***************************************************************************************************************************************************************
//Accuracy 100% 1 Button Toggle On/Off By Default} [!!define "HoldButtonStop" YOU MUST DEFINE THE BUTTON WHICH YOU WILL HAVE TO HOLD SO YOU CAN HEAL YOURSELF.]
define HoldButtonStop  = PS4_R3; // <---- You must define the button on which you want to hold so you can heal yourself
//---------------------------------------------------------------------------------------------------------------------------------------------------------------

//===========================================            //===========================================            
//             Combat Buttons               =            //             Build Buttons                =                 
//===========================================            //===========================================
        define FireBtn    = XB1_RT;                       		 define Build    = PS4_CIRCLE;
        define AdsBtn     = XB1_LT;                       		 define Switch   = PS4_LEFT;
        define Pickaxe    = PS4_TRIANGLE;                        define Wall     = PS4_R2;    
        define Up         = XB1_UP;                       		 define Floor    = PS4_R1;
        define Right      = XB1_RIGHT;                    		 define Ramp     = PS4_L2;	
        define Down       = XB1_DOWN;                    		 define Trap     = PS4_SQUARE;
        define Left       = XB1_LEFT;                     		 define Roof     = PS4_L1;
        define RX         = XB1_RX;                       		 define RY       = XB1_RY;
        define LY         = XB1_LY;                              define LX       = XB1_LX;
     
  

//===============================================================
//                  ADJUSTABLE VARIABLES                                       
//===============================================================
int adjust_variable_idx;                  
int Strenght;
int SpeedStep;
int HeadStep;
int HeadMax;
int AR_Ver;
int AR_Horiz;
int DeadZone;
int Spam_Accuracy:
int StepBloom;
int BuildSyncTime;

const string EditVarStr []={ 
" Strenght Assist",
"   Step Assist",  
"    Head Step",   
"     Head Max",   
"   AR Vertical",  
"  AR Horizontal", 
"    Dead Zone",   
"  Spam_Accuracy", 
"     StepBloom",  
"  BuildSyncTime"  
};

//---Adjustable Variables Count                          
define AMOUNT_OF_VALNAME_IDX = 10; 
define MAX_MODS_COUNT = 6;                          

int modName_idx; 
//  MODS Toggles ------------------------------------------------
  int AimStickLinear    = 1 ; 
  int HeadShotAssist    = 1 ; 
  int Anti_Recoil       = 1 ; 
  int StickNoDeriva     = 1 ; 
  int AccuracyExploit   = 1 ;
  int ReducerBloom      = 1 ;
  int BuildTracker      = 1 ;
//===============================================================
//    MODS TEXT TO DISPLAY                                       
//===============================================================
  const string SILENTAIM    = "SilentAimLinear"; 
  const string HEADSHOT     = "Head Assist"; 
  const string ANTIRECOIL   = "AntiRecoil"; 
  const string DEADZONE     = "No Deriva Stick";
  const string ACCURACY     = "AccuracyExploit";
  const string BLOOMREDUCER = "ReducerBloom";
  const string BUILDTRACKER = "BuildTracker";
//===============================================================
//    TITLE STRING                                               
//===============================================================
const string OFF = "OFF";    
const string ON  = "ON";   
const string SCRIPT_ONOFF  = "SCRIPT WAS";   
const int8 ASCII_NUM[] = { 48,49,50,51,52,53,54,55,56,57};                
const string NO_EDIT_VAR1  = "No Edit Variables";
const string NO_EDIT_VAR2  = "for this MOD";       

const uint8 Options [] = {
  1 ,
 67 ,
  1 ,
  1 ,
  1 ,
  1 ,
  1  
};
const uint8 EditVal [] = {
  1 , 
  1 , 
  1 , 
  1 , 
  1 , 
  1 , 
  1   

};
const uint8 OptRange [][] = {
  { 0 , 1 }, 
  { 2 , 3 },
  { 4 , 5 }, 
  { 6 , 6 }, 
  { 7 , 7 }, 
  { 8 , 8 }, 
  { 9 , 9 } 
};
const uint8 Min_Max_Options [][]={ 
  { 0 , 1 },
  { 0 , 2 }, 
  { 0 , 1 }, 
  { 0 , 1 }, 
  { 0 , 1 }, 
  { 0 , 1 }, 
  { 0 , 1 }  
}; 
const int16 ValRange [][] ={
  { 1,  99 }, 
  { 1,  99 }, 
  { 1,  100}, 
  { 1,  100}, 
  { 1,  99 }, 
  {-99, 99 },
  { 0,  50 }, 
  { 50,100 }, 
  { 20 ,200},  
  { 200 ,5000}
}; 


define Ads_Assist  = FALSE;                     
define Fire_Assist = TRUE;  
int BuildTrack,BuildCount;
int AntirecoilVertical,AntirecoilHorizontal;
int Head;
define HeadAssist      = 1;                          
define HeadHipAssist   = 2;  
int display_title = TRUE;
int display_black,refresh_OLED,ModMenu,ModEdit,display_EDIT;   
int EntireScript_OnOff = TRUE;  
int show_mesage_time; 
int count_black;                      
int need_to_be_save;                 
int BlinckColor = 3;    
define TimeToShowIntroPicture = 30000;
define X = RX;                                    
define Y = RY;                                    
int StepInterval = 1;                           
int time;                                             
int angle, cos_angle_dnatme, sin_angle_dnatme;                      
int actual_X, actual_Y, actual_Magnitude, max_Magnitude;

define ColorOFF  = 0;
define Blue      = 1;
define Red       = 2;
define Green     = 3;
define Pink      = 4;
define SkyBlue   = 5;
define Yellow    = 6;
define White     = 7;
                      
data(                 
  0,0,0, //0. ColorOFF
  2,0,0, //1. Blue     
  0,2,0, //2. Red      
  0,0,2, //3. Green    
  2,2,0, //4. Pink     
  2,0,2, //5. SkyBlue 
  0,2,2, //6. Yellow   
  2,2,2  //7. White    
); // end of data segment-------------- 
// COLOR LED function        
//-------------------------------------------------------------- 

init {  

AimStickLinear      = get_pvar(SPVAR_1,  1,    1,   1); 
HeadShotAssist      = get_pvar(SPVAR_2,  1,    2,   2); 
Anti_Recoil         = get_pvar(SPVAR_3,  1,    1,   1); 
StickNoDeriva       = get_pvar(SPVAR_4,  1,    1,   1); 
AccuracyExploit     = get_pvar(SPVAR_5,  1,    1,   1); 
ReducerBloom        = get_pvar(SPVAR_6,  1,    1,   1); 
Strenght            = get_pvar(SPVAR_7, 15,   99,  15);
SpeedStep           = get_pvar(SPVAR_8,  1,   99,  90);
HeadStep            = get_pvar(SPVAR_9,  1,  100,   3);
HeadMax             = get_pvar(SPVAR_10, 1,  100,  30);
AR_Ver              = get_pvar(SPVAR_11, 1,   99,  30);
AR_Horiz            = get_pvar(SPVAR_12,-99,  99,   0);
DeadZone            = get_pvar(SPVAR_13,  1,  50,  15);
Spam_Accuracy       = get_pvar(SPVAR_14, 50, 100, 100);
StepBloom           = get_pvar(SPVAR_15, 20, 200, 100);
BuildSyncTime       = get_pvar(SPVAR_16,400,4000, 2000);  

slot_numb = get_slot();}



main {
                                  
 
 if(get_ival(XB1_LT))
 {
     
     if(event_press(PS4_SHARE))
     {
        
         EntireScript_OnOff    = !EntireScript_OnOff;
         blinck(EntireScript_OnOff);
         cls_oled(0);
         draw_rectangle();
         display_mod( center_x(sizeof(SCRIPT_ONOFF)- 1, OLED_FONT_MEDIUM_WIDTH) ,SCRIPT_ONOFF [0],EntireScript_OnOff ,1);
         show_mesage_time = 2000;

 		 if(!EntireScript_OnOff) set_Virtual_Machine_Speed(VM_Default); 
     }
 }
                          
 if(show_mesage_time)
 {
     show_mesage_time -= get_rtime();
     if(show_mesage_time <= 0) {
         cls_oled(0);    
     }
 }
                               
 if(EntireScript_OnOff) 
 {
                   
	if(ModEdit || ModMenu) set_Virtual_Machine_Speed(VM_Default);
    if(display_EDIT)
    {                
    	     
        cls_oled(0);                        
        if(EditVal[ modName_idx ] == 0 ){  
		               
		    line_oled(1,45,127,45,1,0);    
		    print( center_x( 17, OLED_FONT_SMALL_WIDTH ), 20, OLED_FONT_SMALL, 1, NO_EDIT_VAR1[0] ); 
		    print( center_x( 12, OLED_FONT_SMALL_WIDTH ), 33, OLED_FONT_SMALL, 1, NO_EDIT_VAR2[0] ); 
		}                                                                                            
		else {
          display_edit( adjust_variable_idx [adjust_variable_idx + 1]);
          adjust_variable_idx [adjust_variable_idx + 1] = edit_val(adjust_variable_idx [adjust_variable_idx + 1] );
		}
   }
    
if(refresh_OLED) 
{ 
       
        cls_oled(0);       
        
        draw_rectangle(); 
     
        if(modName_idx == 0)display_mod( center_x(sizeof(SILENTAIM)    - 1, OLED_FONT_SMALL_WIDTH )  ,SILENTAIM[0]    ,AimStickLinear, Options[ modName_idx ]);
        if(modName_idx == 1)display_mod( center_x(sizeof(HEADSHOT)     - 1, OLED_FONT_SMALL_WIDTH )  ,HEADSHOT[0]     ,HeadShotAssist, Options[ modName_idx ]);
        if(modName_idx == 2)display_mod( center_x(sizeof(ANTIRECOIL)   - 1, OLED_FONT_SMALL_WIDTH )  ,ANTIRECOIL[0]   ,Anti_Recoil,    Options[ modName_idx ]);
        if(modName_idx == 3)display_mod( center_x(sizeof(DEADZONE)     - 1, OLED_FONT_SMALL_WIDTH )  ,DEADZONE[0]     ,StickNoDeriva,  Options[ modName_idx ]);
        if(modName_idx == 4)display_mod( center_x(sizeof(ACCURACY)     - 1, OLED_FONT_SMALL_WIDTH )  ,ACCURACY[0]     ,AccuracyExploit,Options[ modName_idx ]);
        if(modName_idx == 5)display_mod( center_x(sizeof(BLOOMREDUCER) - 1, OLED_FONT_SMALL_WIDTH )  ,BLOOMREDUCER[0] ,ReducerBloom   ,Options[ modName_idx ]);
        if(modName_idx == 6)display_mod( center_x(sizeof(BUILDTRACKER) - 1, OLED_FONT_SMALL_WIDTH )  ,BUILDTRACKER[0] ,BuildTracker   ,Options[ modName_idx ]);            
         refresh_OLED = FALSE; 
    } 
if(display_title) 
{           
            
            cls_oled(0);            
    	      
            DrawLogo(0, 0, 0);
                    
	       ModMenu = FALSE;   
           display_title = FALSE;  
           display_black = TRUE;
                                   
    }                            

if(display_black) 
{                            
        count_black += get_rtime();
        
        if(count_black >= TimeToShowIntroPicture)   
        {                        
            cls_oled(0);         
            count_black = 0;      
            display_black = FALSE; 
        }                         
    }                                                               
   
if(ModEdit) 
{ 
        
        block_all_inputs(); 
        
        if(MenuTimeOut)
        {
            
            CheckIfBtnIsPressed();
        } 
       
       if(event_release(XB1_B))
       {
             
             ModEdit      = FALSE;           
             display_EDIT = FALSE;           
             ModMenu      = TRUE;            
             refresh_OLED = TRUE;   
       }                    
                                                                         
        if(!get_ival(XB1_LT) && event_press(XB1_RIGHT))
        {            
                                         
        	 adjust_variable_idx ++;                 
        	   
        	   if(adjust_variable_idx > OptRange[ modName_idx ][ 1 ])  adjust_variable_idx = OptRange[ modName_idx ][ 1 ]; 
             
             	refresh_OLED = FALSE;      
             	display_EDIT = TRUE;        
        }          
                                                                           
        if(!get_ival(XB1_LT) && event_press(XB1_LEFT))
        {  
                                                               
        	   adjust_variable_idx --;                                      
        	   if(adjust_variable_idx < OptRange[ modName_idx ][ 0 ]) adjust_variable_idx = OptRange[ modName_idx ][ 0 ];
             refresh_OLED = FALSE;      
             display_EDIT = TRUE;        
        }                                                           
          
        if(MenuTimeOut)
        {
            CheckIfBtnIsPressed();
        }
   }          
   if(get_ival(XB1_LT) && event_press(XB1_MENU))
   {  
       
       ModMenu = TRUE;  
                            
                 modName_idx  = 0;                   
                 refresh_OLED = TRUE;      
                 display_EDIT = FALSE;        
                 MenuTimeOut  = menu_time_active;
   }      
                
if(ModMenu)
{  
        block_all_inputs(); 

      if(event_press(XB1_B)){
         
          ModMenu = FALSE;                     
          ModEdit = FALSE;              
          combo_run(MESSAGE);             
      }                    
      
      if(event_press(XB1_A))
      {
         
          ModMenu             = FALSE;   
          adjust_variable_idx = OptRange[ modName_idx ][ 0 ]; 
          ModEdit             = TRUE;   
          display_EDIT        = TRUE; 
      }                    
                                  
                          
        if( !get_ival(XB1_LT) && event_press(XB1_RIGHT))
        { 
                                          
        	   modName_idx ++;                 
        	   if(modName_idx > MAX_MODS_COUNT) modName_idx = 0; 
     
        	   blinck( modName_idx[modName_idx + 1]); 
         
        }                          
        if(!get_ival(XB1_LT) && event_press(XB1_LEFT))
        {  
                                                               
        	  modName_idx --;                                      
        	  if(modName_idx < 0) modName_idx = MAX_MODS_COUNT;
     
        	   blinck( modName_idx[modName_idx + 1]); 
         
          }                        
        
        display_black = FALSE;    
        display_title = FALSE;    
 
        if(!get_ival(XB1_LT))
        {    
             if(event_press(XB1_UP))
             { 
                 modName_idx[modName_idx + 1] = f_go_back( modName_idx[modName_idx + 1] ); 
             }
             if(event_press(XB1_DOWN))
             {
                 modName_idx[modName_idx + 1] = f_go_forward( modName_idx[modName_idx + 1] );
             }
       } 
        refresh_OLED = TRUE;   
        set_val(XB1_UP,0); 
        set_val(XB1_DOWN,0); 
        set_val(XB1_LEFT,0); 
        set_val(XB1_RIGHT,0); 
        
        if(MenuTimeOut)
        {
            CheckIfBtnIsPressed();
        }
    } 
   
if(!ModEdit && !ModMenu)
{
    combo_run(Blink_MOD_ON);          
				
		if( StickNoDeriva  ) { 
            
            RemoveStickNoise();
}
			
			
if (BuildTracker) 
{
        
    if (event_press(Build)) 
    {
            
        BuildTrack = !BuildTrack;
    }
    
        if (BuildTrack) 
        {
            
            BuildCount += get_rtime();
            
            if (event_press(Pickaxe) || BuildCount == BuildSyncTime) 
            {
                
                BuildTrack = FALSE;
                BuildCount = 0;
            }
            
            if (get_ival(Roof) || get_ival(Floor) || get_ival(Ramp) || get_ival(Wall) || get_ival(Trap)) 
                
                BuildCount = 0;
        }
    }
	
if (!BuildTrack) {
			
	
if(HeadShotAssist) 
{
			
	if(get_ival(AdsBtn) && get_ival(FireBtn) || (HeadShotAssist == HeadHipAssist && get_ival(FireBtn))) 
    {
		if (abs(get_ival(RY)) < HeadMax) 
		{ 			
            Head += HeadStep;
			combo_run(HeadAssist_cmb);
		}	
	}             
		if (!get_ival(FireBtn)) Head = 0;
				
		if (Head >= HeadMax) combo_stop(HeadAssist_cmb);
			
    }
		    
if(Anti_Recoil) 
{
    if (get_ival(AdsBtn) && get_ival(FireBtn)) 
    {
            combo_run(AntiRecoil);
	}
}   
		    
if(AimStickLinear)
{
    actual_X = get_ival(X);   
    actual_Y = get_ival(Y);           
    actual_Magnitude = isqrt(pow(actual_X, 2) + pow(actual_Y, 2));  
    max_Magnitude = (actual_Magnitude < 100);                      
                                                                  
    if(!(time++ % StepInterval))
    {                                  
	    angle += SpeedStep;                                                 
    }                                                               
        angle = angle % 360;                                            
        sin_angle_dnatme = Polar_Array[angle % 360];                           
        cos_angle_dnatme = Polar_Array[(angle + 270) % 360];                  
        cos_angle_dnatme = (cos_angle_dnatme * Strenght) / 100;                         
        sin_angle_dnatme = (sin_angle_dnatme * Strenght) / 100;                          
                                                                         
    if((Ads_Assist && get_ival(AdsBtn)) || (Fire_Assist && get_ival(FireBtn)))
    { 
        if(actual_Magnitude <= Strenght)
        {                                                      
            sin_angle_dnatme -= actual_Y;                                                              
            cos_angle_dnatme -= actual_X;                                                                 
            }else {                                                                                       
            sin_angle_dnatme = (sin_angle_dnatme * (200 - ((abs(actual_Y) + actual_Magnitude) / 10) * 10) / 200) * max_Magnitude; 
            cos_angle_dnatme = (cos_angle_dnatme * (200 - ((abs(actual_X) + actual_Magnitude) / 10) * 10) / 200) * max_Magnitude; 
        }                                                  
           set_val(X, calculate(actual_X + cos_angle_dnatme, -100, 100));
           set_val(Y, calculate(actual_Y + sin_angle_dnatme, -100, 100)); 
     } 
} 
                                                 
if(time_to_clear_screen)
{               
    time_to_clear_screen -= get_rtime();
        
       if(time_to_clear_screen <= 0 )
       {     
           QT_MESSAGE_TIMEOUT();     
       }                              
}            
       
if (AccuracyExploit) 
{
	if (event_press(FireBtn) && !get_ival(HoldButtonStop)) 
    {
         combo_run(Accuracy100);
    }
}
        
if(ReducerBloom)
{
    if(get_val(AdsBtn) && get_val(FireBtn))
    {         
 
      	combo_run(AntiBloom);}}}
		    
        } //  end of MODS CODE 
    } //  ENTIRE SCRIPT KILL SWITCH 
} //  end of main block 
///////////////////////////////////////////////////////////////////////////// 
///   COMBO BLOCK                                                             
/////////////////////////////////////////////////////////////////////////////
      
combo AntiBloom 
{	
	set_val(LY,-30);
	wait(StepBloom);
	set_val(LY, 30);
	wait(StepBloom);
	if(StepBloom < 160){
	StepBloom = StepBloom + 10;
	} else {
	StepBloom = 100;
	}
}

combo Accuracy100 
{
    set_val(AdsBtn,100);
    wait(Spam_Accuracy);
}

combo AntiRecoil 
{
    AntirecoilVertical = get_val(PS4_RY) + AR_Ver;  
    if(AntirecoilVertical > 100) AntirecoilVertical = 100;
    if(abs(get_val(PS4_RY)) < abs(AR_Ver) +  5)
    set_val(PS4_RY, (AntirecoilVertical));
    AntirecoilHorizontal = get_val(PS4_RX) + AR_Horiz;
    if(AntirecoilHorizontal > 100) AntirecoilHorizontal = 100;
    if(abs(get_val(PS4_RX)) < abs(AR_Horiz)  + 5)
    set_val(PS4_RX, AntirecoilHorizontal);
}

combo HeadAssist_cmb
{
	set_val(RY,inv(Head) + get_ival(RY));
}
                                                 
int exit_wait = 1500;
combo EXIT 
{     
	wait(exit_wait);     
	cls_oled(0);    
	ModMenu = FALSE;  
	ModEdit = FALSE;    
	display_EDIT  = FALSE; 
	display_title = TRUE; 
}  

combo MESSAGE 
{       
    wait(20);         
    save_toggles ();  
    cls_oled(0);      
    print(horizontal_center_offset(sizeof(EXIT_TXT1), OLED_FONT_MEDIUM ), 2, OLED_FONT_MEDIUM, 1, EXIT_TXT1[0]); 
    print(horizontal_center_offset(sizeof(EXIT_TXT2), OLED_FONT_MEDIUM ), 23, OLED_FONT_MEDIUM, 1, EXIT_TXT2[0]);
    exit_wait = 2000;     
}                        
    
combo BLINK_NOTIFY 
{        
	colourled(BlinckColor);   
	wait(300);                 
	colourled(ColorOFF);        
	wait(100);                  
	colourled(BlinckColor);      
	wait(300);                   
	colourled(ColorOFF);          
}                                

int blink_n ;
combo Blink_MOD_ON   
{
    colourled(Blue);
    wait(500);                 
    colourled(Blue);  
    blink_n +=1; 
    if( blink_n > 0)blink_n = 1; 
}                                
  
// FUCTIONS
//-------------------------------------------------------------------------------------------
function RemoveStickNoise() 
{

  if(isqrt(pow(abs(get_ival(PS4_LX)),2) + pow(abs(get_ival(PS4_LY)),2)) <= DeadZone) {
    set_val(PS4_LX,0);
    set_val(PS4_LY,0);
  }

  if(isqrt(pow(abs(get_ival(PS4_RX)),2) + pow(abs(get_ival(PS4_RY)),2)) <= DeadZone) {
    set_val(PS4_RX,0);
    set_val(PS4_RY,0);
  }
}

int time_to_clear_screen;
function QT_MESSAGE_TIMEOUT ()
{     
	             
	cls_oled(0);    
	display_title  = FALSE;           
}    

function calculate(int v, int lo, int hi) 
{ 
  if(v < lo) return lo;               
  if(v > hi) return hi;        
  return v;     
}     
 
define FONT_STATS_INDEX_WIDTH    = 0; 
define FONT_STATS_INDEX_HEIGHT   = 1; 
define FONT_STATS_INDEX_MAXCHARS = 2;                                     
                                      
function horizontal_center_offset(number_characters, font_size) 
{ 
    return (128 - number_characters * FONT_STATS[font_size][FONT_STATS_INDEX_WIDTH]) / 2;
}             
              
int data_indx;
function colourled(color) 
{  
    for( data_indx = 0; data_indx < 3; data_indx++ ) {
        set_led(data_indx,duint8 ((color * 3) + data_indx));
    }
}

const string EXIT_TXT1 = "Settings";  
const string EXIT_TXT2 = "Was Saved"; 
                                     
function save_toggles () {  
                    
     set_pvar(SPVAR_1,  AimStickLinear); 
     set_pvar(SPVAR_2,  HeadShotAssist); 
     set_pvar(SPVAR_3,  Anti_Recoil); 
     set_pvar(SPVAR_4,  StickNoDeriva); 
     set_pvar(SPVAR_5,  AccuracyExploit);
     set_pvar(SPVAR_6,  ReducerBloom);
     set_pvar(SPVAR_7,  BuildTracker);
     set_pvar(SPVAR_8,  Strenght); 
     set_pvar(SPVAR_9,  SpeedStep); 
     set_pvar(SPVAR_10, HeadStep); 
     set_pvar(SPVAR_11, HeadMax); 
     set_pvar(SPVAR_12, AR_Ver); 
     set_pvar(SPVAR_13, AR_Horiz); 
     set_pvar(SPVAR_14, DeadZone);
     set_pvar(SPVAR_15, Spam_Accuracy);
     set_pvar(SPVAR_16, StepBloom); 
     set_pvar(SPVAR_17, BuildSyncTime);   
     combo_run(EXIT);                  
      
}
                      
//-- VM Speed
define VM_Default = 0;
function set_Virtual_Machine_Speed (f_speed)
{
    if     (f_speed == 0) vm_tctrl(-0);//10 ms Default
    else if(f_speed == 1) vm_tctrl(-2);// 8 ms
    else if(f_speed == 2) vm_tctrl(-4);// 6 ms
    else if(f_speed == 3) vm_tctrl(-6);// 4 ms
    else if(f_speed == 4) vm_tctrl(-8);// 2 ms
    else if(f_speed == 5) vm_tctrl(-9);// 1 ms
}
                       
function blinck ( var)
{  
	if(var){               
		BlinckColor = Green;
	}else{                 
		BlinckColor = Red;    
	}                       
	combo_run(BLINK_NOTIFY); 
}                           
                            
const uint8 FONT_STATS[][] = {  
    {  7, 10, 18 }, // Small    
    { 11, 18, 11 }, // Medium   
    { 16, 26,  7 }  // Large    
};                              
                                
function display_edit(  f_val) 
{
    print(2, 2, OLED_FONT_SMALL, OLED_WHITE, EditVarStr[adjust_variable_idx]); 
    number_to_string(f_val, find_digits(f_val));     
}       
        
function f_go_forward (f_variable) 
{
    f_variable       +=1;   
    if(f_variable  > Min_Max_Options[modName_idx][1] )f_variable  = Min_Max_Options[modName_idx][0]; // max option
    need_to_be_save = TRUE;       
    blinck( f_variable );
    return f_variable;
}

function f_go_back (f_variable) 
{
    f_variable       -=1;   
    if(f_variable  < Min_Max_Options[modName_idx][0] )f_variable  = Min_Max_Options[modName_idx][1]; 
    need_to_be_save = TRUE;       
    blinck( f_variable );
    return f_variable;
}

int ssss;                            
int c_c_c,c_val;   
function number_to_string(f_val,f_digits) 
{                  

    ssss = 1;  c_val = 10000;                            
                                                      
    if(f_val < 0)                      
    {                                                 
         putc_oled(ssss,45);       
         ssss += 1;                                      
         f_val = abs(f_val);                          
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                             
            putc_oled(ssss,ASCII_NUM[f_val / c_val]);    
            f_val = f_val % c_val;                    
            ssss +=  1;                                  
            if(c_c_c == 4)                               
            {                                         
                putc_oled(ssss,44);          
                ssss += 1;                               
            }                                        
        }                                             
        c_val /= 10;                                  
    }                                                
    puts_oled(center_x(ssss - 1,OLED_FONT_MEDIUM_WIDTH),27,OLED_FONT_MEDIUM,ssss - 1,OLED_WHITE); 
}                                                     

int n_str_;                  
int horiz_X_center_sufix;    
function print_number(f_val,f_digits ,print_s_x , print_s_y , f_font) 
{ 
                                                      
    n_str_ = 1;  c_val = 10000;                       
                                                      
    if(f_val < 0)                     
    {                                                 
         putc_oled(n_str_,45);    
         n_str_ += 1;                                 
         f_val = abs(f_val);                          
                                                      
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                              
            putc_oled(n_str_,ASCII_NUM[f_val / c_val]);
            f_val = f_val % c_val;                    
            n_str_ +=  1;                             
                                                      
        }                                             
        c_val /= 10;                                  
    }                                                 
    puts_oled(print_s_x,print_s_y,f_font,n_str_ - 1,OLED_WHITE); 
}                                                                                             
                                                      
int f_min, f_max;
define Y_Arrow = 36;
const string EDIT_VALUE_TXT = "Hold LT/L2 +"; 
function edit_val( f_val) 
{  
    line_oled(1,14,127,14,1,1);                                        
    line_oled(1,48,127,48,1,1); 
     
    print( 2, 52, OLED_FONT_SMALL, 1, EDIT_VALUE_TXT[0] ); 
    rect_oled(90, 50, 127, 60, OLED_WHITE , col_rec_left); 
    putc_oled(1,LEFT_arrow); 
    puts_oled(91, 51, OLED_FONT_SMALL, 1, col_char_left);     
    putc_oled(1,RIGHT_arrow); 
    puts_oled(101, 51, OLED_FONT_SMALL, 1, col_char_right);
    
    putc_oled(1,UP_arrow); 
    puts_oled(111, 51, OLED_FONT_SMALL, 1, col_char_left);     
    putc_oled(1,DOWN_arrow); 
    puts_oled(121, 51, OLED_FONT_SMALL, 1, col_char_right);
    
    f_min = ValRange[adjust_variable_idx][0];                          
    f_max = ValRange[adjust_variable_idx][1];  
     
    print_number(f_min ,find_digits(f_min) ,4 , 20 , OLED_FONT_SMALL); 
    print_number(f_max ,find_digits(f_max) ,97 , 20 , OLED_FONT_SMALL);
                                          
    if(get_ival(XB1_LT))
    {                  
        if(press_hold(PS4_RIGHT)){            
            f_val ++;                           
            if(f_val > f_max ) f_val = f_max;   
            display_EDIT = TRUE;                
            need_to_be_save = TRUE;             
        }                                     
                                          
        if(press_hold(PS4_LEFT))
        {             
            f_val --;                           
            if(f_val < f_min ) f_val = f_min;   
            display_EDIT = TRUE;                
            need_to_be_save = TRUE;             
        }                                     
        if(press_hold(PS4_UP))
        {               
            f_val +=10;                         
            if(f_val > f_max ) f_val = f_max;   
            display_EDIT = TRUE;                
            need_to_be_save = TRUE;             
        }                                     
                                          
        if(press_hold(PS4_DOWN))
    {             
            f_val -=10;                         
            if(f_val < f_min ) f_val = f_min;   
            display_EDIT = TRUE;                
            need_to_be_save = TRUE;             
        }                                     
    }                                      
    return f_val;                        
}    
                                             
function press_hold(f_btn) 
{       

	  return event_press(f_btn) || get_ival(f_btn) && get_ptime(f_btn) > 250 
	       && get_ptime(f_btn) % (get_rtime() * 8) == 0;
}               
                
function find_digits(f_num) 
{                         
                                                 
    f_num = abs(f_num);                               
    if(f_num / 10000 > 0) return 5;                   
    if(f_num /  1000 > 0) return 4;                   
    if(f_num /   100 > 0) return 3;                   
    if(f_num /    10 > 0) return 2;                   
                          return 1;                  
}                                                     
                              
function center_x(f_chars,f_font) 
{           
                                                    
    return (OLED_WIDTH / 2) - ((f_chars * f_font) / 2); 
}                                                      
                                                       
function draw_rectangle()        
{
    rect_oled(0, 0,OLED_WIDTH,64,FALSE,1); 
    line_oled(1,14,127,14,1,1); 
    line_oled(1,48,127,48,1,1); 
}
const string ModOption_67_0 = "OFF"; 
const string ModOption_67_1 = "Head Assist"; 
const string ModOption_67_2 = "HHip Assist"; 
define ShotModOptions = 31;
define FireModOptions =  9;
const string ModOption_31_0 = "Disable"; 
const string ModOption_31_1 = "Fire Only"; 
const string ModOption_31_2 = "ADS & Fire"; 
const string ModOption_31_3 = "ADS Only"; 
const string ModOption_31_4 = "On Fire"; 
define UP_arrow = 131; 
define DOWN_arrow = 132; 
define LEFT_arrow = 133; 
define RIGHT_arrow = 134; 
define TRIANGLE_txt = 130; 
define Y_txt = 89; 
define CROSS_txt = 127; 
define A_txt = 65;
int col_char_left; 
int col_char_right;
int col_rec_left = 1;
int col_rec_right = 1;
define SINGLE     = 21;
define ROW_1      = 21;
define ROW_2      = 33;
const string NO_EDIT_VARIABLE =" No Edit Variable";
const string PRESS_A_TO_EDIT  =" A/CROSS to Edit ";
const string MOD_LABEL        ="MOD:";
const string SLOT_LABEL       ="MSL:";
int slot_numb ;
function display_mod( f_string, mod_name, f_toggle, f_option) 
{   
                                      
        print(f_string, 2, OLED_FONT_SMALL, OLED_WHITE, mod_name); 
        print( 2,38,OLED_FONT_SMALL, OLED_WHITE, MOD_LABEL[0]); 
        print_number(modName_idx + 1 ,find_digits(modName_idx + 1) ,28 , 38 , OLED_FONT_SMALL);
        print( 84,38,OLED_FONT_SMALL, OLED_WHITE, SLOT_LABEL[0]); 
        print_number(slot_numb ,find_digits(slot_numb) ,112 , 38 , OLED_FONT_SMALL); 
                                                       
        rect_oled(55, Y_Arrow, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_WHITE , col_rec_left); 
        rect_oled(63, Y_Arrow, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_WHITE, col_rec_right);
        
        putc_oled(1,DOWN_arrow); 
        puts_oled(56, 37, OLED_FONT_SMALL, 1, col_char_left);     
        putc_oled(1,UP_arrow); 
        puts_oled(64, 37, OLED_FONT_SMALL, 1, col_char_right);
                                                               
		if(EditVal[ modName_idx ] == 0 ){ 
			print( 2, 52, OLED_FONT_SMALL, 1, NO_EDIT_VARIABLE[0] ); 
		}else{
			print( 2, 52, OLED_FONT_SMALL, 1, PRESS_A_TO_EDIT[0] ); 
        }
        if(f_option == 1)                              
        {                                                     
                                      
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ON)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ON[0]);// Enable 
            else                                                                                               
                print(center_x(sizeof(OFF) - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,OFF[0]);// Disable 
        }            
        if(f_option == ShotModOptions)// 31    
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                           
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_31_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_3[0]);// ADS Only
                                                                                                                           
        }            
        if(f_option == FireModOptions)// 9 FireModOptions   
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                 
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_31_4)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_4[0]);// On Fire
                                                                                                                 
        }         

        if(f_option == 67)   
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_67_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_67_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_67_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_67_1[0]);// Head Assist
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_67_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_67_2[0]);// HHip Assist
                                                                                                                           
        }            
}//display mod end           

/*     
======================================================
     Logo Picture : FORTNITE
======================================================
*/                                                    
                               
 const int16 BOOT_LOGO[] = { 
123, 62,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3F7E,0xFEFE,0x85DF,0xDF80,0x0000,0x0000,0x0000,0x0007,0xEFDF,0xDFD8,0xBBFB,0xF000,0x0000,0x0000,0x0000,0x00FD,0x0A08,0x4312,0x0840,0x0000,0x0000,0x0000,0x0000,
    0x1821,0x4108,0x7241,0x0800,0x0000,0x0000,0x0000,0x0003,0x0428,0x210A,0x4821,0x0000,0x0000,0x0000,0x0000,0x0060,0x853C,0x2169,0x0420,0x0000,0x0000,0x0000,0x0000,0x0C10,0xA604,0x2520,0x8400,0x0000,0x0000,0x0000,0x0001,0xFA14,
    0x8084,0xE410,0xF800,0x0000,0x0000,0x0000,0x003F,0x4290,0x108C,0x821F,0x0000,0x0000,0x0000,0x0000,0x0608,0x5302,0x1190,0x4200,0x0000,0x0000,0x0000,0x0000,0xC10A,0x3842,0x3208,0x4000,0x0000,0x0000,0x0000,0x0018,0x2147,0x0842,
    0x4108,0x0000,0x0000,0x0000,0x0000,0x0304,0x2861,0x0848,0x2100,0x0000,0x0006,0x4C00,0x0000,0x60FD,0x0C21,0x0B84,0x3F00,0x0000,0x00C9,0x8000,0x000C,0x1FA1,0x8421,0x7087,0xE000,0x0000,0xC9B7,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0000,0x0019,0x36C0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x01B6,0xB000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x1EF6,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,0xFF80,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0070,0x1000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0002,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xF7C0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x001F,0xF800,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0301,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x6060,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,0xF000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0004,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0FF9,0xC183,
    0xFE30,0x03FC,0x67FF,0xE0E0,0x3DFF,0xFC02,0x061C,0x61E0,0xEF00,0x83DC,0x07F8,0x0603,0x81FE,0x0040,0x01C8,0x1C0C,0xE030,0x3B83,0x0000,0xE030,0xC000,0x1800,0x1E03,0x81DC,0x0603,0x30C0,0x000E,0x0430,0x0003,0xFFC1,0xC070,0x3B81,
    0xC066,0x3000,0x00C1,0x8600,0x0060,0x003C,0x0E03,0x7038,0x0CC6,0x0000,0x1C61,0xC000,0x0C00,0x05C1,0x804E,0x0701,0x98E0,0x0001,0xC838,0x0001,0xC001,0x9C30,0x19C0,0x6023,0x1C00,0x001A,0x0380,0x001C,0x00E1,0xC706,0x380F,0x0861,
    0xE040,0x0180,0x7800,0x01FC,0x181C,0xFF87,0xFCFE,0x0C1F,0xF000,0x2007,0xFC00,0x0600,0x0018,0x0001,0x0701,0x00F0,0x0008,0x001E,0x0000,0x0000,0x0300,0x0000,0x0000,0x0000,0x0300,0x0000,0x0000,0x0000,0x6000,0x0000,0x0000,0x0000,
    0x4000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x000C,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x03C0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x03DE,0xF0F5,0x1D17,0xC7D6,0x2000,0x0000,0x0000,0x0000,0x4A52,0x30A2,0x2220,0x8AEC,0x0000,0x0000,
    0x0000,0x0009,0x4A44,0x1446,0x4411,0x5580,0x0000,0x0000,0x0000,0x012B,0x4882,0x88E8,0x822A,0xF000,0x0000,0x0000,0x0000,0x3DC9,0x1E51,0xD710,0x7D4A,0x0000,0x0000,0x0000,0x0004,0x2920,0x6A22,0x6208,0xA840,0x0000,0x0000,0x0000,
    0x0084,0xA40D,0x444C,0x4115,0x0800,0x0000,0x0000,0x0000,0x1094,0x80A8,0x8888,0x22A1,0x0000,0x0000,0x0000,0x0002,0x12F1,0xF5DD,0x1104,0x5420,0x0000,0x0000,0x0000,0x0040,0x0000,0x0000,0x0000,0x0000,0x0000
}                                              
int logoX,logoX2,logoY, logoY2;                       
int logoBit,logoOffset,logoData;                      
                                                      
function DrawLogo(x, y, invert) 
{                     
    logoOffset = 2;                                    
    logoBit = 16;                                           
    for (logoY = 0; logoY < BOOT_LOGO[1]; logoY++) 
    {        
        for (logoX = 0; logoX < BOOT_LOGO[0]; logoX++) 
        {     
            logoData = BOOT_LOGO[logoOffset]          
            logoX2 = x + logoX;                       
            logoY2 = y + logoY;                       
            if (logoX2 < 0 || logoX2 >= 128) 
            {        
                logoX2 -= 128;                        
            }                                         
            if (logoY2 < 0 || logoY2 >= 64) 
            {         
                logoY2 -= 64;                         
            }                                         
            if (test_bit(logoData, logoBit - 1)) 
            {     
                pixel_oled(logoX2, logoY2, !invert);   
            }else{                                     
                pixel_oled(logoX2, logoY2, invert);    
            }                                            
            logoBit--;             
            if (!logoBit) 
            {   
                logoBit = 16;     
                logoOffset++;     
            }  
        }   
    }    
}     
      
const uint8 MenuButtons [] = {  
  XB1_UP ,   //0. Up
  XB1_DOWN , //1. Down
  XB1_LEFT , //2. go back
  XB1_RIGHT ,//3. go forward
  XB1_A ,    //4. enter in Edit Menu
  XB1_B ,    //5. exit  Menu
  XB1_MENU , //5. enter in  Menu
  XB1_LT     //6. hold ADS
};//--- End Menu Buttons  

int menu_btn_indx;
int MenuTimeOut;
define menu_time_active = 30000;
function CheckIfBtnIsPressed (){  
    for(menu_btn_indx = 0; menu_btn_indx < 7; menu_btn_indx++)
    {
         if(event_press(MenuButtons[menu_btn_indx]) )
         {
             MenuTimeOut = menu_time_active;
         }
         if(MenuTimeOut)
         {              
            MenuTimeOut -=1;
            if(MenuTimeOut <= 0 )
            {    
                ModMenu = FALSE;      
                ModEdit = FALSE;      
                display_EDIT  = FALSE; 
                display_black = TRUE; 
            }
        }
    }
}

const int8 Polar_Array[]={100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,    
80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7, 
6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,  
-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95, 
-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,   
-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61, 
-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,
9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,
82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100};      


/*
 . 'oxlc:. .  .cc.    ..  .. ..  .:ko. ''....      ...  .'..,,'. .... ..,.....,.....;;..c:...'.   ...
  .;,'c:.    .;;.    .'  .. ..   ':'  ,,......   .;'.. ...':;,.        ...''.'..'''c:...'.....  .'..
  .:;.:l,..  'lc..   ..  ',...  .,l:. .......     ......'...,;.  ....  ....''::.  .;;. .,,..'.  .,;,
  .cc';c'.   .;.     ''..,,...  .':,.            ...........:c'  ..........',;:....,:..''.. ..  .,'.
  .,c;:l,.   .:;.    ..'.',...                  ..''''''.....    ...  ........'..''::..,,'..'.  .''.
  'lo:;,..   .,,.    ....,,..                  .'''''''''',''...  ........'.,ll',,.,;..;,....   .','
  .c:'''. .  .;c'    ....;,.           .      .'''''''''''',,,,,'...  .  .',,:c..'.'' ......'.    ..
  .:'     .  .,:'    .....       .....''......''''''''''''''''',,,''..  ....,oo'.. ..      .'.  ....
  .;:,,,..   .,,.    ..        ..'''''''''''''''''''''''''''''''',,'''..  . .::....;;. .......   ...
  .lo::;'.   .:;.    ..       ..''''''''''''''''''''''''''''''''''',,'''.   .c:.,;.;:..;,...'.  .',.
  .;xo::;..  .,:'             .''''''''''''''''''''''''''''''''''''',,,''..  ...',.,;..cc,....  .',,
   ;dl:;. .  .;:.             .'''''''''''''''''''''''''''''''''''''''''''.. .;..'.',..::.....  .,'.
  .;c;c;.    .';.             .''''''''''''''''''''''''''''''''''''''''''''. .'..''::. ''.....   ...
  .:. ...    .cc.       .     .''''''''''''''''''''''''''''''''''''..'''''''. .......    ...'.  .','
  ..  ...    .;,.      .'.    .''''''''''''''''''''''''''''.....'..  ...''','.  ...'.    .....  .''.
  ..  ....   .;,.      ...    ..'....''''''''.''''.......       ..     ..''''.  ....'.   .....   ...
  .'. ';,..  .,'      ...                ...   .                        ..'''.. .'.,,.  .'....   ...
. .,. ';...  ..      .'.           ...                                   ..'''..  .,;.   ....    ';,
  .;. ''..   ..     .'..         .,;;;;;;,,''.....      ...',,;:'         ..''''. .,;.   .      .;,.
  .'..;,. .  .     ..'.         .:ccllooooooooollllccccccloolcccc;.        .''''. .:c.    ....  .,'.
      ,:'..       ..''.        'ccloddxddddddddddddddddddddxxdoooll;.       .''''..':.   .....  .;;'
  ... ;c'...      .''.       .:lllodxxxxxxxxxxxxxxxxxxxxxxxkkkxxddooc,.      .''''..;'  ....,.  ....
  .:. ':;..       .'.       .,:codxxxxxxxxxxxxxxxxxxxxxxxxxkkkkxxxdoc;.      ..''''...  .'....      
. 'o, .,...      .'..      ..   .';cdxxxxxxxxxxxxxxxxxxxkkkkkxdoc;'.         .'''',.     ....    ...  
       .'.       ...     .o0Kx'     .,cdxxxxxxxxxxxxxxkkkkkdc,..    ..       ..''','.    .. ..  .''.
      .,..      .'.      'OWMX:        .,lxxxxxxxxxxxxkkko;.       ,kd.        ..'',.    .. ..  ....   CREATED BY EXPLOIT YT
      .'.       ..      ...:l;           .;oxxxxxxxxxxxd;.          ..           ..',.     ...    ..
      ,;.               .. .,.             .lxxxxxxxxxl.                           .''.   ..'.    ..         FORTNITE 
      .,.                .'.,:;.            .ldxxddddc.            .'.              .'.  . .'.  ...'
      ';.                 ,;'.,,.           .:ddddool'  .        .cl;.               .,. ...'.  .,,'
      .;.                 .;c;,..         .':odxxddol:'.         ..',,.              .,. ...'.  .,,'
      ..                   .:c::::;,'''',:looddxxxxdolcc:,'....',;lo:.               .,.  ..'.  .''.
                            .clcclllllloooddxxxxxxxxddooooooooooodo;                 .'.    .   ....
                             .colloddddxxxxxxxxxxxxxxxxxddxxxxxdxl'                  ..         .;,.
                              .;llloddxxxxxxxoc;,,,:oxxxxxkkkkxd:.                   .          ....
.                               .:lloddxxxxdl.      .cxxxxkkkdc'                    ..          .''.
                                  ,coooddxdo:,'',,,,;cdxxxxdc'                     ..           .,'.
                                   .,cloddddolccccclodddxo:.                      .             .',.
      .'                             ..:loddddddoodddddl;.                                  .   .',.
      ,c.                               .':ldxxxxxxdo:'                                     ..   . .
      .'.                                  ..;cll:,'.                                       ..  ..  
.     .;,.                                                                               .. ..  ....
      .,'.                                                                               .  .   .;:'
.     .,'.                                                                 .''.         ..       ...
      ..                                                   .            ..''..         .''....  ....
      ..                                        ............         ..''..          ..'',,'.   ... 
                                            ..'''''''''''.        ......            .''''',,,.. .;;.
           ...        .....                  .''''''''''..     .....                .'''''',,''...'.
         ..'''.         .''...          .....''''''''''''............               ..'''''',,''. ..
        ..'''''..        ..'''...     ..'''''''''''''''''''......'''...             ..''''''',,''.  
       .'''''''''.         ...''''.... .''''''''''''''''''''''''''''''.....          .''''''',,,''. 
 ..   .'''''''''''..         .''''''''''''''''''''''''''''''''''','''''''..          .'''''''',,''..*/
 